{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport io from 'socket.io-client';\nimport axios from 'axios';\nexport default {\n  name: 'MainChat',\n  data() {\n    return {\n      bottom: '',\n      message: '',\n      connection: null,\n      socket: io.connect(),\n      messages: [{\n        \"name\": \"kaziu\",\n        \"message\": \"sd\"\n      }]\n    };\n  },\n  methods: {\n    sendMessage() {\n      if (this.message === '') return;\n      this.socket.emit('sendMessage', {\n        message: this.message,\n        name: localStorage.getItem('user_name')\n      });\n      this.resetIcon();\n      this.clearMessage();\n    },\n    clearMessage() {\n      this.message = '';\n    },\n    resetIcon() {\n      this.iconIndex = 0;\n    },\n    changeIcon() {\n      this.iconIndex === this.icons.length - 1 ? this.iconIndex = 0 : this.iconIndex++;\n    }\n  },\n  created() {\n    const self = this;\n    this.socket.on('getMessage', function (data) {\n      console.log(this.messages);\n      self.messages.push(...data);\n      if (window.scrollY === document.documentElement.scrollHeight - window.innerHeight) {\n        setTimeout(() => {\n          window.scrollTo(0, document.body.scrollHeight);\n        }, 200);\n      }\n    });\n    axios.post('/chat_history', {\n      headers: {\n        'Content-Type': 'application/json'\n      }\n    }).then(response => {\n      const history = response.data.history;\n      console.log(typeof history);\n      console.log(Object.values(history));\n      this.messages.push(Object.values(history));\n      console.log(this.messages);\n    });\n  }\n};","map":{"version":3,"names":["io","axios","name","data","bottom","message","connection","socket","connect","messages","methods","sendMessage","emit","localStorage","getItem","resetIcon","clearMessage","iconIndex","changeIcon","icons","length","created","self","on","console","log","push","window","scrollY","document","documentElement","scrollHeight","innerHeight","setTimeout","scrollTo","body","post","headers","then","response","history","Object","values"],"sources":["C:\\Users\\micha\\Desktop\\kazcom\\src\\components\\MainChat.vue"],"sourcesContent":["<template>\r\n  <v-container style=\"height: 90%;\">\r\n    <v-row :scroll-target=\"onScroll\" style=\"padding-bottom: 100px;\">\r\n      <v-card v-for=\"message in messages\" :key=\"message.name\" :title=\"message.name\" variant=\"tonal\"\r\n        :text=\"message.message\" style=\"height: 100px; width: 100%; margin: 10px 10px 10px 10px;\"></v-card>\r\n    </v-row>\r\n  </v-container>\r\n  <v-text-field class=\"textFieldWidth\" label=\"Napisz wiadomość...\" v-model=\"message\"\r\n    :append-icon=\"message ? 'mdi-send' : 'mdi-emoticon'\" variant=\"filled\" clear-icon=\"mdi-close-circle\" type=\"text\"\r\n    @click:append=\"sendMessage\" @click:prepend=\"changeIcon\" @click:clear=\"clearMessage\"\r\n    @keyup.enter=\"sendMessage\"></v-text-field>\r\n</template>\r\n\r\n<script>\r\nimport io from 'socket.io-client'\r\nimport axios from 'axios'\r\n\r\nexport default {\r\n  name: 'MainChat',\r\n  data() {\r\n    return {\r\n      bottom: '',\r\n      message: '',\r\n      connection: null,\r\n      socket: io.connect(),\r\n      messages: [\r\n        {\r\n          \"name\": \"kaziu\",\r\n          \"message\": \"sd\",\r\n        }\r\n      ]\r\n    }\r\n  }, methods: {\r\n    sendMessage() {\r\n      if (this.message === '') return\r\n      this.socket.emit('sendMessage', { message: this.message, name: localStorage.getItem('user_name') });\r\n      this.resetIcon()\r\n      this.clearMessage()\r\n    },\r\n    clearMessage() {\r\n      this.message = ''\r\n    },\r\n    resetIcon() {\r\n      this.iconIndex = 0\r\n    },\r\n    changeIcon() {\r\n      this.iconIndex === this.icons.length - 1 ? this.iconIndex = 0 : this.iconIndex++\r\n    }\r\n  },\r\n  created() {\r\n    const self = this\r\n    this.socket.on('getMessage', function (data) {\r\n      console.log(this.messages)\r\n\r\n      self.messages.push(...data)\r\n      if (window.scrollY === document.documentElement.scrollHeight - window.innerHeight) {\r\n        setTimeout(() => {\r\n          window.scrollTo(0, document.body.scrollHeight);\r\n        }, 200)\r\n      }\r\n    })\r\n\r\n\r\n\r\n    axios.post('/chat_history', {\r\n      headers: { 'Content-Type': 'application/json' }\r\n    })\r\n      .then(response => {\r\n        const history = response.data.history\r\n        console.log(typeof (history))\r\n        console.log(Object.values(history))\r\n        this.messages.push(Object.values(history))\r\n        console.log(this.messages)\r\n      })\r\n  }\r\n}\r\n</script>\r\n\r\n<style>\r\n* {\r\n  scroll-behavior: smooth;\r\n}\r\n\r\n@media screen and (min-width: 1279px) {\r\n  .textFieldWidth {\r\n    position: fixed;\r\n    right: 20vw;\r\n    left: 20vw;\r\n  }\r\n}\r\n\r\n@media screen and (max-width: 1280px) {\r\n  .textFieldWidth {\r\n    position: fixed;\r\n    left: 10px;\r\n    bottom: 0;\r\n    right: 10px;\r\n  }\r\n}\r\n\r\n::-webkit-scrollbar {\r\n  width: 10px;\r\n  border-radius: 10px 0 0 10px;\r\n}\r\n\r\n::-webkit-scrollbar-track {\r\n  border-radius: 10px 0 0 10px;\r\n  background: #ffffff;\r\n}\r\n\r\n::-webkit-scrollbar-thumb {\r\n  border-radius: 10px 0 0 10px;\r\n  background: rgb(224, 224, 224)\r\n}\r\n\r\n::-webkit-scrollbar-thumb:hover {\r\n  border-radius: 10px 0 0 10px;\r\n  background: #555;\r\n}\r\n</style>"],"mappings":";AAcA,OAAOA,EAAC,MAAO,kBAAiB;AAChC,OAAOC,KAAI,MAAO,OAAM;AAExB,eAAe;EACbC,IAAI,EAAE,UAAU;EAChBC,IAAIA,CAAA,EAAG;IACL,OAAO;MACLC,MAAM,EAAE,EAAE;MACVC,OAAO,EAAE,EAAE;MACXC,UAAU,EAAE,IAAI;MAChBC,MAAM,EAAEP,EAAE,CAACQ,OAAO,EAAE;MACpBC,QAAQ,EAAE,CACR;QACE,MAAM,EAAE,OAAO;QACf,SAAS,EAAE;MACb;IAEJ;EACF,CAAC;EAAEC,OAAO,EAAE;IACVC,WAAWA,CAAA,EAAG;MACZ,IAAI,IAAI,CAACN,OAAM,KAAM,EAAE,EAAE;MACzB,IAAI,CAACE,MAAM,CAACK,IAAI,CAAC,aAAa,EAAE;QAAEP,OAAO,EAAE,IAAI,CAACA,OAAO;QAAEH,IAAI,EAAEW,YAAY,CAACC,OAAO,CAAC,WAAW;MAAE,CAAC,CAAC;MACnG,IAAI,CAACC,SAAS,EAAC;MACf,IAAI,CAACC,YAAY,EAAC;IACpB,CAAC;IACDA,YAAYA,CAAA,EAAG;MACb,IAAI,CAACX,OAAM,GAAI,EAAC;IAClB,CAAC;IACDU,SAASA,CAAA,EAAG;MACV,IAAI,CAACE,SAAQ,GAAI;IACnB,CAAC;IACDC,UAAUA,CAAA,EAAG;MACX,IAAI,CAACD,SAAQ,KAAM,IAAI,CAACE,KAAK,CAACC,MAAK,GAAI,IAAI,IAAI,CAACH,SAAQ,GAAI,IAAI,IAAI,CAACA,SAAS,EAAC;IACjF;EACF,CAAC;EACDI,OAAOA,CAAA,EAAG;IACR,MAAMC,IAAG,GAAI,IAAG;IAChB,IAAI,CAACf,MAAM,CAACgB,EAAE,CAAC,YAAY,EAAE,UAAUpB,IAAI,EAAE;MAC3CqB,OAAO,CAACC,GAAG,CAAC,IAAI,CAAChB,QAAQ;MAEzBa,IAAI,CAACb,QAAQ,CAACiB,IAAI,CAAC,GAAGvB,IAAI;MAC1B,IAAIwB,MAAM,CAACC,OAAM,KAAMC,QAAQ,CAACC,eAAe,CAACC,YAAW,GAAIJ,MAAM,CAACK,WAAW,EAAE;QACjFC,UAAU,CAAC,MAAM;UACfN,MAAM,CAACO,QAAQ,CAAC,CAAC,EAAEL,QAAQ,CAACM,IAAI,CAACJ,YAAY,CAAC;QAChD,CAAC,EAAE,GAAG;MACR;IACF,CAAC;IAID9B,KAAK,CAACmC,IAAI,CAAC,eAAe,EAAE;MAC1BC,OAAO,EAAE;QAAE,cAAc,EAAE;MAAmB;IAChD,CAAC,EACEC,IAAI,CAACC,QAAO,IAAK;MAChB,MAAMC,OAAM,GAAID,QAAQ,CAACpC,IAAI,CAACqC,OAAM;MACpChB,OAAO,CAACC,GAAG,CAAC,OAAQe,OAAQ;MAC5BhB,OAAO,CAACC,GAAG,CAACgB,MAAM,CAACC,MAAM,CAACF,OAAO,CAAC;MAClC,IAAI,CAAC/B,QAAQ,CAACiB,IAAI,CAACe,MAAM,CAACC,MAAM,CAACF,OAAO,CAAC;MACzChB,OAAO,CAACC,GAAG,CAAC,IAAI,CAAChB,QAAQ;IAC3B,CAAC;EACL;AACF"},"metadata":{},"sourceType":"module","externalDependencies":[]}