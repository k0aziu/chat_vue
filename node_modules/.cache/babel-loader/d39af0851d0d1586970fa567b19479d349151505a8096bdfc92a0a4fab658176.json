{"ast":null,"code":"import { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, resolveComponent as _resolveComponent, createBlock as _createBlock, withCtx as _withCtx, createVNode as _createVNode, withKeys as _withKeys } from \"vue\";\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_v_card = _resolveComponent(\"v-card\");\n  const _component_v_row = _resolveComponent(\"v-row\");\n  const _component_v_container = _resolveComponent(\"v-container\");\n  const _component_v_text_field = _resolveComponent(\"v-text-field\");\n  return _openBlock(), _createElementBlock(_Fragment, null, [_createVNode(_component_v_container, {\n    style: {\n      \"height\": \"90%\"\n    }\n  }, {\n    default: _withCtx(() => [_createVNode(_component_v_row, {\n      \"scroll-target\": _ctx.onScroll,\n      style: {\n        \"padding-bottom\": \"100px\"\n      }\n    }, {\n      default: _withCtx(() => [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($data.messages, message => {\n        return _openBlock(), _createBlock(_component_v_card, {\n          key: message.name,\n          title: message.name,\n          variant: \"tonal\",\n          text: message.message,\n          style: {\n            \"height\": \"100px\",\n            \"width\": \"100%\",\n            \"margin\": \"10px 10px 10px 10px\"\n          }\n        }, null, 8, [\"title\", \"text\"]);\n      }), 128))]),\n      _: 1\n    }, 8, [\"scroll-target\"])]),\n    _: 1\n  }), _createVNode(_component_v_text_field, {\n    class: \"textFieldWidth\",\n    label: \"Napisz wiadomość...\",\n    modelValue: $data.message,\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $data.message = $event),\n    \"append-icon\": $data.message ? 'mdi-send' : 'mdi-emoticon',\n    variant: \"filled\",\n    \"clear-icon\": \"mdi-close-circle\",\n    type: \"text\",\n    \"onClick:append\": $options.sendMessage,\n    \"onClick:prepend\": $options.changeIcon,\n    \"onClick:clear\": $options.clearMessage,\n    onKeyup: _withKeys($options.sendMessage, [\"enter\"])\n  }, null, 8, [\"modelValue\", \"append-icon\", \"onClick:append\", \"onClick:prepend\", \"onClick:clear\", \"onKeyup\"])], 64);\n}","map":{"version":3,"names":["_createVNode","_component_v_container","style","_component_v_row","_ctx","onScroll","_createElementBlock","_Fragment","_renderList","$data","messages","message","_createBlock","_component_v_card","key","name","title","variant","text","_component_v_text_field","class","label","$event","type","$options","sendMessage","changeIcon","clearMessage","onKeyup","_withKeys"],"sources":["C:\\Users\\micha\\Desktop\\kazcom\\src\\components\\MainChat.vue"],"sourcesContent":["<template>\r\n  <v-container style=\"height: 90%;\">\r\n    <v-row :scroll-target=\"onScroll\" style=\"padding-bottom: 100px;\">\r\n      <v-card v-for=\"message in messages\" :key=\"message.name\" :title=\"message.name\" variant=\"tonal\"\r\n        :text=\"message.message\" style=\"height: 100px; width: 100%; margin: 10px 10px 10px 10px;\"></v-card>\r\n    </v-row>\r\n  </v-container>\r\n  <v-text-field class=\"textFieldWidth\" label=\"Napisz wiadomość...\" v-model=\"message\"\r\n    :append-icon=\"message ? 'mdi-send' : 'mdi-emoticon'\" variant=\"filled\" clear-icon=\"mdi-close-circle\" type=\"text\"\r\n    @click:append=\"sendMessage\" @click:prepend=\"changeIcon\" @click:clear=\"clearMessage\"\r\n    @keyup.enter=\"sendMessage\"></v-text-field>\r\n</template>\r\n\r\n<script>\r\nimport io from 'socket.io-client'\r\nimport axios from 'axios'\r\n\r\nexport default {\r\n  name: 'MainChat',\r\n  data() {\r\n    return {\r\n      bottom: '',\r\n      message: '',\r\n      connection: null,\r\n      socket: io.connect(),\r\n      messages: []\r\n    }\r\n  }, methods: {\r\n    sendMessage() {\r\n      if (this.message === '') return\r\n      this.socket.emit('sendMessage', { message: this.message, name: localStorage.getItem('user_name') });\r\n      this.resetIcon()\r\n      this.clearMessage()\r\n    },\r\n    clearMessage() {\r\n      this.message = ''\r\n    },\r\n    resetIcon() {\r\n      this.iconIndex = 0\r\n    },\r\n    changeIcon() {\r\n      this.iconIndex === this.icons.length - 1 ? this.iconIndex = 0 : this.iconIndex++\r\n    }\r\n  },\r\n  created() {\r\n    const self = this\r\n    this.socket.on('getMessage', function (data) {\r\n      console.log(this.messages)\r\n\r\n      self.messages.push(...data)\r\n      if (window.scrollY === document.documentElement.scrollHeight - window.innerHeight) {\r\n        setTimeout(() => {\r\n          window.scrollTo(0, document.body.scrollHeight);\r\n        }, 200)\r\n      }\r\n    })\r\n\r\n\r\n\r\n    axios.post('/chat_history', {\r\n      headers: { 'Content-Type': 'application/json' }\r\n    })\r\n      .then(response => {\r\n        const history = JSON.parse(response.config.data)\r\n        console.log(...history)\r\n        this.messages.push(...history)\r\n        console.log(this.messages)\r\n      })\r\n  }\r\n}\r\n</script>\r\n\r\n<style>\r\n* {\r\n  scroll-behavior: smooth;\r\n}\r\n\r\n@media screen and (min-width: 1279px) {\r\n  .textFieldWidth {\r\n    position: fixed;\r\n    right: 20vw;\r\n    left: 20vw;\r\n  }\r\n}\r\n\r\n@media screen and (max-width: 1280px) {\r\n  .textFieldWidth {\r\n    position: fixed;\r\n    left: 10px;\r\n    bottom: 0;\r\n    right: 10px;\r\n  }\r\n}\r\n\r\n::-webkit-scrollbar {\r\n  width: 10px;\r\n  border-radius: 10px 0 0 10px;\r\n}\r\n\r\n::-webkit-scrollbar-track {\r\n  border-radius: 10px 0 0 10px;\r\n  background: #ffffff;\r\n}\r\n\r\n::-webkit-scrollbar-thumb {\r\n  border-radius: 10px 0 0 10px;\r\n  background: rgb(224, 224, 224)\r\n}\r\n\r\n::-webkit-scrollbar-thumb:hover {\r\n  border-radius: 10px 0 0 10px;\r\n  background: #555;\r\n}\r\n</style>"],"mappings":";;;;;;6DACEA,YAAA,CAKcC,sBAAA;IALDC,KAAoB,EAApB;MAAA;IAAA;EAAoB;sBAC/B,MAGQ,CAHRF,YAAA,CAGQG,gBAAA;MAHA,eAAa,EAAEC,IAAA,CAAAC,QAAQ;MAAEH,KAA8B,EAA9B;QAAA;MAAA;;wBACvB,MAA2B,E,kBAAnCI,mBAAA,CACoGC,SAAA,QAAAC,WAAA,CAD1EC,KAAA,CAAAC,QAAQ,EAAnBC,OAAO;6BAAtBC,YAAA,CACoGC,iBAAA;UAD/DC,GAAG,EAAEH,OAAO,CAACI,IAAI;UAAGC,KAAK,EAAEL,OAAO,CAACI,IAAI;UAAEE,OAAO,EAAC,OAAO;UAC1FC,IAAI,EAAEP,OAAO,CAACA,OAAO;UAAET,KAAgE,EAAhE;YAAA;YAAA;YAAA;UAAA;;;;;;MAG9BF,YAAA,CAG4CmB,uBAAA;IAH9BC,KAAK,EAAC,gBAAgB;IAACC,KAAK,EAAC,qBAAqB;gBAAUZ,KAAA,CAAAE,OAAO;+DAAPF,KAAA,CAAAE,OAAO,GAAAW,MAAA;IAC9E,aAAW,EAAEb,KAAA,CAAAE,OAAO;IAAgCM,OAAO,EAAC,QAAQ;IAAC,YAAU,EAAC,kBAAkB;IAACM,IAAI,EAAC,MAAM;IAC9G,gBAAY,EAAEC,QAAA,CAAAC,WAAW;IAAG,iBAAa,EAAED,QAAA,CAAAE,UAAU;IAAG,eAAW,EAAEF,QAAA,CAAAG,YAAY;IACjFC,OAAK,EAAAC,SAAA,CAAQL,QAAA,CAAAC,WAAW"},"metadata":{},"sourceType":"module","externalDependencies":[]}